# 🚀 JenGen Backend

A **production-ready Node.js + Express backend** built with TypeScript for Next.js applications, featuring **email-first user registration**, **generated wallet management**, and **comprehensive security middleware**.

![Node.js](https://img.shields.io/badge/Node.js-v20+-green.svg)
![TypeScript](https://img.shields.io/badge/TypeScript-5.3+-blue.svg)
![Express](https://img.shields.io/badge/Express-4.18+-lightgrey.svg)
![Security](https://img.shields.io/badge/Security-Enhanced-red.svg)
![Base Blockchain](https://img.shields.io/badge/Base-Blockchain-blue.svg)

## 📋 Table of Contents

- [🎯 Overview](#-overview)
- [✨ Key Features](#-key-features)
- [🛡️ Security Features](#-security-features)
- [🗃️ Database Support](#-database-support)
- [⚡ Quick Start](#-quick-start)
- [🔧 Configuration](#-configuration)
- [📚 API Documentation](#-api-documentation)
  - [🏥 Health Endpoints](#-health-endpoints)
  - [👥 User Management](#-user-management)
  - [🎯 Membership Management](#-membership-management)
- [📊 Data Structures](#-data-structures)
- [🚀 Deployment](#-deployment)
- [🛠️ Development](#-development)
- [📊 Monitoring](#-monitoring)
- [🤝 Contributing](#-contributing)

## 🎯 Overview

JenGen Backend is designed for **Web3 applications** that need secure user management with blockchain integration. Unlike traditional wallet-first approaches, it uses **email-first registration** where wallets are **generated by WalletConnect/Reown** after user registration.

### 🎪 Registration Flow

```
1. User Registration (Email + Username)
   ↓
2. Wallet Generation (WalletConnect/Reown)
   ↓
3. Signature Verification (Base Blockchain)
   ↓
4. Complete User Profile
   ↓
5. Access Membership Tiers
```

## ✨ Key Features

### 🔐 **Email-First Registration Flow**
- **Step 1**: Register with email and username
- **Step 2**: Wallet generated via WalletConnect/Reown
- **Step 3**: Signature verification on Base blockchain

### 👥 **User Management**
- **Structured Names**: `first_name` and `last_name` support
- **Unique Usernames**: Validation with reserved name protection  
- **Base ENS Integration**: `.base.eth` domain support
- **UUID Primary Keys**: Scalable user identification

### 🎯 **Membership System**
- **4 Tier System**: Basic, Pro, Premium, Enterprise
- **JSONB Features**: Flexible membership benefits storage
- **Auto-Seeding**: Default tiers created automatically

### ⛓️ **Base Blockchain Integration**
- **Chain ID**: 8453 (Base Mainnet)
- **Generated Wallets**: Via WalletConnect/Reown
- **SIWE Authentication**: Sign-In with Ethereum
- **ENS Support**: Base domain resolution

## 🛡️ Security Features

### 🔒 **Comprehensive Protection**

| Security Layer | Implementation | Status |
|----------------|----------------|---------|
| **Rate Limiting** | 1000 req/15min (dev), 100 req/15min (prod) | ✅ Active |
| **Auth Rate Limiting** | 5 req/15min for registration/wallet endpoints | ✅ Active |
| **Input Validation** | Express-validator with custom rules | ✅ Active |
| **XSS Prevention** | Script sanitization + CSP headers | ✅ Active |
| **SQL Injection** | Parameterized queries + sanitization | ✅ Active |
| **NoSQL Injection** | MongoDB sanitization middleware | ✅ Active |
| **CORS Protection** | Configured origins + preflight | ✅ Active |
| **Security Headers** | Helmet.js + custom headers | ✅ Active |
| **Request Logging** | Morgan + security event detection | ✅ Active |
| **Error Handling** | Production-safe error messages | ✅ Active |
| **Parameter Pollution** | HPP protection middleware | ✅ Active |

### 🚨 **Security Monitoring**
- **Attack Pattern Detection**: SQL injection, XSS, path traversal
- **Malicious User Agent Detection**: Security scanners, bots
- **Performance Monitoring**: Slow requests, memory usage
- **404 Tracking**: Reconnaissance attempt detection

## 🗃️ Database Support

### 📊 **Triple Database Architecture**

The backend supports **3 database modes** with automatic fallback:

```
Priority: Supabase > PostgreSQL > In-Memory
```

#### 🟢 **Supabase (Recommended)**
```bash
# Set environment variables
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
```

#### 🐘 **PostgreSQL**
```bash
# Set environment variable
POSTGRES_URL=postgresql://user:password@localhost:5432/jengen
```

#### 💾 **In-Memory (Development)**
- **No configuration required**
- **6 pre-loaded dummy users**
- **4 membership tiers**
- **Perfect for development and testing**

## ⚡ Quick Start

### 📦 **Installation**

```bash
# Clone the repository
git clone <your-repo-url>
cd backend

# Install dependencies
npm install

# Start development server
npm run dev
```

### 🚀 **Server Will Start With:**

```
🚀 Server running on http://localhost:4000
🛡️  Security: Enhanced middleware enabled
📊 Health check (JSON) at http://localhost:4000/api/health
🏥 Health dashboard (HTML) at http://localhost:4000/api/health/table
👥 Users API (email-first registration) at http://localhost:4000/api/users
📧 Register user at http://localhost:4000/api/users/register
🔗 Generate wallet at http://localhost:4000/api/users/:id/generate-wallet
🎯 Memberships API available at http://localhost:4000/api/memberships
⛓️  Base blockchain (Chain ID: 8453)
🔄 CORS enabled for: http://localhost:3000
⚡ Rate limiting: 1000 req/15min
🔒 Security headers: Enabled
📝 Request logging: Colored
```

## 🔧 Configuration

### 🌍 **Environment Variables**

Create a `.env` file in the backend directory:

```env
# Server Configuration
PORT=4000
NODE_ENV=development
FRONTEND_URL=http://localhost:3000

# Database Configuration (Choose one)
# Supabase (Recommended)
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key

# PostgreSQL
POSTGRES_URL=postgresql://user:password@localhost:5432/jengen

# Security (Optional)
API_KEY_REQUIRED=false
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
```

## 📚 API Documentation

### 🏥 Health Endpoints

| Method | Endpoint | Description | Rate Limit |
|--------|----------|-------------|------------|
| `GET` | `/api/health` | System health status (JSON) | Unlimited |
| `GET` | `/api/health/table` | System health dashboard (HTML) | Unlimited |

#### **GET /api/health**

**Description**: Returns comprehensive system health information in JSON format.

**Headers**: None required

**Response Structure**:
```json
{
  "status": "healthy" | "degraded" | "error",
  "timestamp": "2025-01-01T12:00:00.000Z",
  "version": "1.0.0",
  "environment": "development" | "production",
  "database": {
    "mode": "supabase" | "postgres" | "in-memory",
    "status": {
      "connected": true,
      "userCount": 6,
      "membershipCount": 4
    }
  },
  "system": {
    "platform": "darwin",
    "arch": "arm64", 
    "nodeVersion": "v20.0.0",
    "totalMemory": "65536 MB",
    "freeMemory": "32768 MB",
    "cpus": 10,
    "loadAverage": [1.2, 1.5, 1.8]
  },
  "blockchain": {
    "network": "Base",
    "chainId": 8453,
    "rpcUrl": "https://mainnet.base.org",
    "blockExplorer": "https://basescan.org",
    "walletGeneration": "WalletConnect/Reown",
    "registrationFlow": "email-first"
  },
  "features": {
    "emailFirstRegistration": true,
    "generatedWallets": true,
    "membershipTiers": 4,
    "tripleDatabase": true,
    "baseBlockchain": true
  }
}
```

#### **GET /api/health/table**

**Description**: Beautiful HTML dashboard with system overview, database status, and monitoring metrics.

**Headers**: None required

**Response**: HTML page with real-time system information, auto-refreshes every 30 seconds.

---

### 👥 User Management

| Method | Endpoint | Description | Rate Limit |
|--------|----------|-------------|------------|
| `POST` | `/api/users/register` | Register new user (Step 1) | 5 req/15min |
| `POST` | `/api/users/:id/generate-wallet` | Generate wallet (Step 2) | 5 req/15min |
| `GET` | `/api/users` | Get all users with pagination | 1000 req/15min |
| `GET` | `/api/users/:id` | Get user by ID | 1000 req/15min |
| `PUT` | `/api/users/:id` | Update user information | 1000 req/15min |
| `DELETE` | `/api/users/:id` | Delete user account | 1000 req/15min |
| `GET` | `/api/users/:userId/membership` | Get user's membership | 1000 req/15min |
| `PUT` | `/api/users/:userId/membership` | Update user's membership | 1000 req/15min |

#### **POST /api/users/register**

**Description**: Register new user with email and username (Step 1 of 2-step registration).

**Headers**:
```
Content-Type: application/json
```

**Request Body**:
```json
{
  "email": "john.doe@example.com",
  "username": "johndoe",
  "name": {
    "first_name": "John",
    "last_name": "Doe"
  }
}
```

**Validation Rules**:
- `email`: Valid email format, max 254 characters, unique
- `username`: 3-30 characters, alphanumeric + underscore/hyphen, unique
- `name.first_name`: 1-50 characters, letters/spaces/hyphens/apostrophes only (optional)
- `name.last_name`: 1-50 characters, letters/spaces/hyphens/apostrophes only (optional)

**Success Response (201)**:
```json
{
  "success": true,
  "user": {
    "id": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
    "email": "john.doe@example.com",
    "username": "johndoe",
    "name": {
      "first_name": "John",
      "last_name": "Doe"
    },
    "walletAddress": "",
    "membershipTier": {
      "id": "1",
      "name": "Tier 1 - Basic",
      "price": 0,
      "features": ["Basic access to platform", "Standard support"]
    },
    "membershipAssignedAt": "2025-01-01T12:00:00.000Z",
    "isWalletVerified": false,
    "walletType": "WalletConnect",
    "createdAt": "2025-01-01T12:00:00.000Z",
    "updatedAt": "2025-01-01T12:00:00.000Z"
  },
  "message": "User registered successfully. Next step: generate wallet.",
  "nextStep": "generate_wallet"
}
```

**Error Responses**:
```json
// 400 - Validation Error
{
  "error": {
    "message": "Validation failed",
    "status": 400,
    "details": [
      {
        "field": "email",
        "message": "Must be a valid email address",
        "value": "invalid-email",
        "location": "body"
      }
    ]
  }
}

// 409 - Conflict (Email/Username exists)
{
  "error": {
    "message": "Sorry username is taken or unavailable",
    "status": 409
  }
}
```

#### **POST /api/users/:id/generate-wallet**

**Description**: Generate and verify wallet for registered user (Step 2 of 2-step registration).

**Headers**:
```
Content-Type: application/json
```

**URL Parameters**:
- `id`: User UUID (must be valid UUID v4)

**Request Body**:
```json
{
  "userId": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
  "walletAddress": "0x742d35Cc6634C0532925a3b8D48e67c8b0c2b618",
  "signature": "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef12",
  "message": "Sign in to JenGen with your wallet on Base blockchain"
}
```

**Validation Rules**:
- `userId`: Valid UUID v4 format
- `walletAddress`: Valid Ethereum address (42 chars, starts with 0x)
- `signature`: Valid hex signature (132 chars, starts with 0x)
- `message`: 1-1000 characters

**Success Response (200)**:
```json
{
  "success": true,
  "user": {
    "id": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
    "email": "john.doe@example.com",
    "username": "johndoe",
    "name": {
      "first_name": "John",
      "last_name": "Doe"
    },
    "walletAddress": "0x742d35Cc6634C0532925a3b8D48e67c8b0c2b618",
    "ensName": null,
    "membershipTier": {
      "id": "1",
      "name": "Tier 1 - Basic",
      "price": 0,
      "features": ["Basic access to platform", "Standard support"]
    },
    "membershipAssignedAt": "2025-01-01T12:00:00.000Z",
    "isWalletVerified": true,
    "walletType": "WalletConnect",
    "lastWalletConnection": "2025-01-01T12:00:00.000Z",
    "createdAt": "2025-01-01T12:00:00.000Z",
    "updatedAt": "2025-01-01T12:00:00.000Z"
  },
  "walletGenerated": true,
  "message": "Wallet generated and verified successfully"
}
```

#### **GET /api/users**

**Description**: Get all users with pagination, sorting, and search support.

**Headers**: None required

**Query Parameters**:
- `page`: Page number (1-1000, default: 1)
- `limit`: Results per page (1-100, default: 10)
- `sortBy`: Sort field (`createdAt`, `updatedAt`, `email`, `username`)
- `sortOrder`: Sort direction (`asc`, `desc`)
- `q`: Search query (1-100 characters, alphanumeric + @._-)

**Example Request**:
```
GET /api/users?page=1&limit=10&sortBy=createdAt&sortOrder=desc&q=john
```

**Success Response (200)**:
```json
{
  "users": [
    {
      "id": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
      "email": "john.doe@example.com",
      "username": "johndoe",
      "name": {
        "first_name": "John",
        "last_name": "Doe"
      },
      "walletAddress": "0x742d35Cc6634C0532925a3b8D48e67c8b0c2b618",
      "ensName": "johndoe.base.eth",
      "membershipTier": {
        "id": "2",
        "name": "Tier 2 - Pro",
        "price": 29.99,
        "features": ["All Basic features", "Priority support", "Advanced analytics"]
      },
      "membershipAssignedAt": "2025-01-01T12:00:00.000Z",
      "isWalletVerified": true,
      "walletType": "WalletConnect",
      "lastWalletConnection": "2025-01-01T12:00:00.000Z",
      "createdAt": "2025-01-01T12:00:00.000Z",
      "updatedAt": "2025-01-01T12:00:00.000Z"
    }
  ],
  "total": 6,
  "blockchain": "Base",
  "chainId": 8453
}
```

#### **GET /api/users/:id**

**Description**: Get user by ID with full membership details.

**URL Parameters**:
- `id`: User UUID (must be valid UUID v4)

**Success Response (200)**:
```json
{
  "user": {
    "id": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
    "email": "john.doe@example.com",
    "username": "johndoe",
    "name": {
      "first_name": "John",
      "last_name": "Doe"
    },
    "walletAddress": "0x742d35Cc6634C0532925a3b8D48e67c8b0c2b618",
    "ensName": "johndoe.base.eth",
    "membershipTier": {
      "id": "2",
      "name": "Tier 2 - Pro",
      "price": 29.99,
      "features": [
        "All Basic features",
        "Priority support", 
        "Advanced analytics",
        "API access"
      ]
    },
    "membershipAssignedAt": "2025-01-01T12:00:00.000Z",
    "isWalletVerified": true,
    "walletType": "WalletConnect",
    "lastWalletConnection": "2025-01-01T12:00:00.000Z",
    "createdAt": "2025-01-01T12:00:00.000Z",
    "updatedAt": "2025-01-01T12:00:00.000Z"
  }
}
```

#### **PUT /api/users/:id**

**Description**: Update user information (email, username, name, ENS name).

**Headers**:
```
Content-Type: application/json
```

**URL Parameters**:
- `id`: User UUID (must be valid UUID v4)

**Request Body** (all fields optional):
```json
{
  "email": "newemail@example.com",
  "username": "newusername",
  "name": {
    "first_name": "NewFirst",
    "last_name": "NewLast"
  },
  "ensName": "newname.base.eth"
}
```

**Success Response (200)**:
```json
{
  "user": {
    // Updated user object with new values
  }
}
```

#### **DELETE /api/users/:id**

**Description**: Delete user account permanently.

**URL Parameters**:
- `id`: User UUID (must be valid UUID v4)

**Success Response (204)**: No content

---

### 🎯 Membership Management

| Method | Endpoint | Description | Rate Limit |
|--------|----------|-------------|------------|
| `GET` | `/api/memberships` | Get all membership tiers | 1000 req/15min |
| `GET` | `/api/memberships/:id` | Get membership tier by ID | 1000 req/15min |
| `POST` | `/api/memberships` | Create new membership tier | 1000 req/15min |
| `PUT` | `/api/memberships/:id` | Update membership tier | 1000 req/15min |
| `DELETE` | `/api/memberships/:id` | Delete membership tier | 1000 req/15min |

#### **GET /api/memberships**

**Description**: Get all available membership tiers.

**Success Response (200)**:
```json
{
  "memberships": [
    {
      "id": "1",
      "name": "Tier 1 - Basic",
      "price": 0,
      "features": [
        "Basic access to platform",
        "Standard support",
        "Community forum access"
      ],
      "createdAt": "2025-01-01T12:00:00.000Z",
      "updatedAt": "2025-01-01T12:00:00.000Z"
    },
    {
      "id": "2", 
      "name": "Tier 2 - Pro",
      "price": 29.99,
      "features": [
        "All Basic features",
        "Priority support",
        "Advanced analytics",
        "API access",
        "Custom integrations"
      ],
      "createdAt": "2025-01-01T12:00:00.000Z",
      "updatedAt": "2025-01-01T12:00:00.000Z"
    },
    {
      "id": "3",
      "name": "Tier 3 - Premium", 
      "price": 79.99,
      "features": [
        "All Pro features",
        "White-label solution",
        "Dedicated account manager",
        "Custom reporting",
        "Advanced security features",
        "Multi-chain wallet support"
      ],
      "createdAt": "2025-01-01T12:00:00.000Z",
      "updatedAt": "2025-01-01T12:00:00.000Z"
    },
    {
      "id": "4",
      "name": "Tier 4 - Enterprise",
      "price": 199.99,
      "features": [
        "All Premium features",
        "Unlimited API calls",
        "Custom development",
        "SLA guarantee",
        "On-premise deployment",
        "Advanced compliance tools",
        "Dedicated infrastructure"
      ],
      "createdAt": "2025-01-01T12:00:00.000Z",
      "updatedAt": "2025-01-01T12:00:00.000Z"
    }
  ],
  "total": 4
}
```

#### **GET /api/users/:userId/membership**

**Description**: Get user's current membership details.

**URL Parameters**:
- `userId`: User UUID (must be valid UUID v4)

**Success Response (200)**:
```json
{
  "membership": {
    "user": {
      "id": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
      "email": "john.doe@example.com",
      "username": "johndoe"
    },
    "currentTier": {
      "id": "2",
      "name": "Tier 2 - Pro",
      "price": 29.99,
      "features": [
        "All Basic features",
        "Priority support",
        "Advanced analytics",
        "API access",
        "Custom integrations"
      ]
    },
    "assignedAt": "2025-01-01T12:00:00.000Z",
    "isActive": true
  }
}
```

#### **PUT /api/users/:userId/membership**

**Description**: Update user's membership tier.

**Headers**:
```
Content-Type: application/json
```

**URL Parameters**:
- `userId`: User UUID (must be valid UUID v4)

**Request Body**:
```json
{
  "membershipTierId": "3"
}
```

**Validation Rules**:
- `membershipTierId`: Must be one of: "1", "2", "3", "4"

**Success Response (200)**:
```json
{
  "membership": {
    "user": {
      "id": "usr_01jhq2x8y9z1a2b3c4d5e6f7g8h9",
      "email": "john.doe@example.com",
      "username": "johndoe"
    },
    "previousTier": {
      "id": "2",
      "name": "Tier 2 - Pro"
    },
    "newTier": {
      "id": "3",
      "name": "Tier 3 - Premium",
      "price": 79.99,
      "features": [
        "All Pro features",
        "White-label solution",
        "Dedicated account manager",
        "Custom reporting",
        "Advanced security features",
        "Multi-chain wallet support"
      ]
    },
    "updatedAt": "2025-01-01T12:00:00.000Z"
  },
  "message": "Membership tier updated successfully"
}
```

## 📊 Data Structures

### 👤 **User Model**

```typescript
interface User {
  id: string;                    // UUID - primary identifier  
  email: string;                 // Required - primary registration field
  username: string;              // Required - unique username
  name?: {                       // Optional - structured name
    first_name: string;
    last_name: string;
  };
  walletAddress: string;         // Required - generated by WalletConnect/Reown
  ensName?: string;              // Optional ENS name on Base
  membershipTierId: string;      // Required - defaults to '1' (Basic)
  membershipAssignedAt: Date;    // Required
  isWalletVerified: boolean;     // Required - starts false, verified via WalletConnect
  walletType: string;            // Required - always 'WalletConnect' for generated wallets
  lastWalletConnection?: Date;   // Optional
  createdAt: Date;
  updatedAt: Date;
}
```

### 🎯 **Membership Model**

```typescript
interface Membership {
  id: string;                    // Membership tier ID (1-4)
  name: string;                  // Tier name (e.g., "Tier 1 - Basic")
  price: number;                 // Monthly price in USD
  features: string[];            // Array of feature descriptions
  createdAt: Date;
  updatedAt: Date;
}
```

### 🔗 **Request/Response Interfaces**

```typescript
// Registration request
interface CreateUserRequest {
  email: string;                 // Required - primary field
  username: string;              // Required - unique username
  name?: {                       // Optional - structured name
    first_name: string;
    last_name: string;
  };
}

// Wallet generation request  
interface WalletGeneratedRequest {
  userId: string;                // User who requested wallet generation
  walletAddress: string;         // Generated wallet address from WalletConnect/Reown
  signature: string;             // Verification signature
  message: string;               // Signed message
}

// User update request
interface UpdateUserRequest {
  username?: string;             // Can update username (must be unique)
  name?: {                       // Can update structured name
    first_name: string;
    last_name: string;
  };
  email?: string;                // Can update email (must be unique)
  ensName?: string;              // Can update ENS name
}

// Response interfaces
interface UserResponse {
  id: string;
  email: string;
  username: string;
  name?: {
    first_name: string;
    last_name: string;
  };
  walletAddress?: string;        // Only present after wallet generation
  ensName?: string;
  membershipTier?: {
    id: string;
    name: string;
    price: number;
    features: string[];
  };
  membershipAssignedAt: string;
  isWalletVerified: boolean;
  walletType: string;
  lastWalletConnection?: string;
  createdAt: string;
  updatedAt: string;
}

// Registration response
interface CreateUserResponse {
  success: boolean;
  user: UserResponse;
  message: string;
  nextStep: 'generate_wallet';   // Always next step after registration
}

// Wallet generation response
interface WalletGeneratedResponse {
  success: boolean;
  user: UserResponse;
  walletGenerated: boolean;
  message: string;
}
```

### ⛓️ **Blockchain Constants**

```typescript
const BASE_CHAIN = {
  chainId: 8453,
  name: 'Base',
  rpcUrl: 'https://mainnet.base.org',
  blockExplorer: 'https://basescan.org'
} as const;

const SUPPORTED_WALLET_TYPES = [
  'MetaMask',
  'Coinbase Wallet', 
  'WalletConnect',  // Primary type for generated wallets
  'Rainbow',
  'Frame'
] as const;
```

## 🚀 Deployment

### 🌐 **Environment Setup**

#### Development
```bash
NODE_ENV=development
PORT=4000
FRONTEND_URL=http://localhost:3000
```

#### Production
```bash
NODE_ENV=production
PORT=4000
FRONTEND_URL=https://your-frontend-domain.com
SUPABASE_URL=your_production_supabase_url
SUPABASE_ANON_KEY=your_production_supabase_key
```

### ☁️ **Deployment Platforms**

| Platform | Configuration | Auto-Deploy | Database |
|----------|--------------|-------------|-----------|
| **Vercel** | `vercel.json` + env vars | ✅ Git push | Supabase |
| **Railway** | Connect GitHub repo | ✅ Git push | Built-in PostgreSQL |
| **Heroku** | `Procfile` + buildpacks | ✅ Git push | PostgreSQL addon |
| **DigitalOcean** | Docker + env config | Manual | Managed PostgreSQL |

## 🛠️ Development

### 🏗️ **Project Structure**

```
jg-back/
├── backend/
│   ├── src/
│   │   ├── controllers/           # Route handlers and business logic
│   │   │   ├── userController.ts      # User CRUD operations
│   │   │   └── membershipController.ts # Membership management
│   │   ├── middleware/            # Express middleware stack
│   │   │   ├── security.ts            # Rate limiting, headers, sanitization
│   │   │   ├── validation.ts          # Input validation rules
│   │   │   ├── logging.ts             # Request/error/security logging
│   │   │   └── errorHandler.ts        # Error handling & custom errors
│   │   ├── models/                # TypeScript interfaces & types
│   │   │   ├── User.ts                # User data structures
│   │   │   └── Membership.ts          # Membership data structures
│   │   ├── routes/                # Express route definitions
│   │   │   ├── userRoutes.ts          # User endpoints with validation
│   │   │   ├── membershipRoutes.ts    # Membership endpoints
│   │   │   └── healthRoutes.ts        # Health monitoring endpoints
│   │   ├── utils/                 # Utility functions & clients
│   │   │   ├── supabaseClient.ts      # Supabase connection & queries
│   │   │   ├── postgresClient.ts      # PostgreSQL connection & schemas
│   │   │   └── walletUtils.ts         # Blockchain validation utilities
│   │   ├── data/                  # Static data and fixtures
│   │   │   └── dummyData.ts           # Development seed data
│   │   └── index.ts               # Application entry point
│   ├── package.json               # Dependencies and scripts
│   ├── tsconfig.json             # TypeScript configuration
│   └── .env                      # Environment variables (not in git)
└── README.md                     # This documentation
```

### ⚙️ **NPM Scripts**

| Script | Command | Description |
|--------|---------|-------------|
| `dev` | `nodemon src/index.ts` | Development server with hot reload |
| `build` | `tsc` | Compile TypeScript to JavaScript |
| `start` | `node dist/index.js` | Production server |
| `clean` | `rm -rf dist` | Clean compiled files |

## 📊 Monitoring

### 🎯 **Health Dashboard**

Visit `http://localhost:4000/api/health/table` for real-time monitoring:

- **System Status**: CPU, memory, uptime, Node.js version
- **Database Health**: Connection status, record counts, mode
- **Security Metrics**: Rate limits, blocked requests, attack detection
- **Performance Data**: Response times, memory usage, slow queries
- **API Overview**: All endpoints, CORS settings, feature flags

### 📈 **Logging Levels**

#### Development
```
🔍 404 NOT FOUND: GET /unknown-route from ::1
⚠️  CLIENT ERROR: Invalid email format from user registration
❌ SERVER ERROR: Database connection failed
⚡ PERFORMANCE: Slow request took 2.5s
🚨 SECURITY EVENT: SQL injection attempt detected
```

#### Production
```json
{"timestamp":"2025-01-01T12:00:00.000Z","level":"error","message":"Database connection failed","context":{...}}
```

## 🤝 Contributing

### 📋 **Development Guidelines**

1. **Security First**: All inputs validated, no sensitive data in logs
2. **TypeScript Strict**: Full type safety with strict mode
3. **Error Handling**: Custom error classes with proper status codes
4. **Testing**: Add tests for new endpoints (framework coming soon)
5. **Documentation**: Update README for new features/endpoints

### 🔄 **Pull Request Process**

1. Fork repository & create feature branch
2. Follow existing code patterns & TypeScript conventions
3. Add validation for new endpoints
4. Update API documentation in README
5. Test with all database modes (in-memory, PostgreSQL, Supabase)
6. Submit PR with detailed description

---

## 📞 Support & Links

- **Health Dashboard**: [http://localhost:4000/api/health/table](http://localhost:4000/api/health/table)
- **API Docs**: This README
- **Base Blockchain**: [https://base.org](https://base.org)
- **WalletConnect**: [https://walletconnect.com](https://walletconnect.com)

---

<div align="center">

**Built with ❤️ for the Web3 ecosystem**

[![Node.js](https://img.shields.io/badge/Node.js-339933?logo=nodedotjs&logoColor=white)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![Express](https://img.shields.io/badge/Express-000000?logo=express&logoColor=white)](https://expressjs.com/)
[![Base](https://img.shields.io/badge/Base-0052FF?logo=coinbase&logoColor=white)](https://base.org/)

*JenGen Backend - Production-ready Web3 user management*

</div>